---
import Base from "../../layout/Baselayout.astro";

import { getCollection } from "astro:content";
const sales = await getCollection("sales");

const costCalc = (cost: number) => {
  if (cost > 10000) {
    return `${cost / 10000} silver`;
  } else if (cost > 100) {
    return `${cost / 100} copper`;
  }
};
---
<Base title="Sales by Jackjones">
  <div class="blog-panel">
    <h1 class="satisfy-regular">Sales</h1>
    <p>
      I make stuff, sell stuff, can make more stuff, will make more stuff, will sell you someofmy stuff...
    </p>

    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>QL</th>
          <th>Casts</th>
          <th>Categories</th>
          <th>Cost</th>
        </tr>
      </thead>
      <tbody>
        {
          sales.map((p) => (
            <tr>
              <td>
                {p.data.name} ({p.data.material})
              </td>
              <td>{p.data.ql}</td>
              <td>
                {p.data.castsRecord?.map((record) =>
                  Object.entries(record).map(
                    ([key, value]) => `${key} ${value} `
                  )
                )}
              </td>
              <td>{p.data.category.join(" | ")}</td>
              <td>{costCalc(p.data.cost)}</td>
            </tr>
          ))
        }
      </tbody>
    </table>
  </div>
</Base>
